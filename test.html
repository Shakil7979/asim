<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magnific Popup with Draggable Image</title>
    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- Include jQuery UI for draggable feature -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!-- Include Magnific Popup CSS and JS files -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <!-- Include Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Add your custom styles here */
        .floowPlanPopup {
            cursor: zoom-in;
        }

        .custom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: column;
            z-index: 9999;
        }

        .custom-controls span {
            cursor: pointer;
            margin-bottom: 10px;
            font-size: 20px; /* Adjust the font size as needed */
        }

        .mfp-container {
            overflow: hidden;
        }

        .mfp-with-zoom img {
            transition: transform 0.5s ease-in-out;
            transform-origin: center center;
        }

        .ui-draggable-dragging {
            cursor: move;
        }
    </style>
</head>
<body>

<!-- Your content goes here -->

<!-- Example image link with zoom controls -->
<a class="floowPlanPopup" href="assets/images/masterPlanePopUp.png">
    <img src="assets/images/masterplan.png" alt="masterplan images">
</a>

<!-- Initialize Magnific Popup with draggable, clickable zoom controls, and mouse move drag -->
<script>
    $(document).ready(function () {
        var isDraggableInitialized = false;

        // Initialize Magnific Popup
        $('.floowPlanPopup').magnificPopup({
            type: 'image',
            closeOnContentClick: false,  // Disable closing on image click
            closeBtnInside: false,
            mainClass: 'mfp-with-zoom',
            image: {
                verticalFit: true,
                titleSrc: function (item) {
                    return item.el.attr('title') + '<small>by Author</small>';
                }
            },
            zoom: {
                enabled: true,
                duration: 300,
                opener: function (element) {
                    return element.find('img');
                }
            },
            callbacks: {
                open: function () {
                    // Add custom zoom controls to the popup
                    var customControls = '<div class="custom-controls">' +
                        '<span class="zoom-in"><i class="fas fa-plus"></i></span>' +
                        '<span class="zoom-out"><i class="fas fa-minus"></i></span>' +
                        '</div>';
                    $(customControls).appendTo('.mfp-container');

                    // Initialize custom zoom controls
                    $('.zoom-in').click(function (e) {
                        e.stopPropagation();
                        zoomIn();
                    });

                    $('.zoom-out').click(function (e) {
                        e.stopPropagation();
                        zoomOut();
                    });

                    // Initialize draggable behavior only if not already initialized
                    if (!isDraggableInitialized) {
                        // Make the image draggable using jQuery UI
                        var $mfpContent = $('.mfp-content');
                        $mfpContent.draggable({
                            start: function (event, ui) {
                                var $container = $(this).parent();
                                var containerWidth = $container.width();
                                var containerHeight = $container.height();
                                var elementWidth = $(this).width();
                                var elementHeight = $(this).height();

                                // Set the containment dynamically based on image and container dimensions
                                $(this).draggable('option', 'containment', [
                                    -(elementWidth - containerWidth), // left
                                    0, // top
                                    0, // right
                                    -(elementHeight - containerHeight) // bottom
                                ]);
                            },
                            cursor: 'move'
                        });

                        isDraggableInitialized = true;
                    }
                }
            }
        });

        function zoomIn() {
            var img = $('.mfp-with-zoom img');
            var currentScale = parseFloat(img.css('transform').split(',')[3]) || 1;
            img.css('transform', 'scale(' + (currentScale + 0.2) + ')');
        }

        function zoomOut() {
            var img = $('.mfp-with-zoom img');
            var currentScale = parseFloat(img.css('transform').split(',')[3]) || 1;
            img.css('transform', 'scale(' + (currentScale - 0.2) + ')');
        }
    });
</script>

</body>
</html>
